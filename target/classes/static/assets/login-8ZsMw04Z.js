import{d as S,r as g,m as T,u as E,n as $,a as V,b as j,_ as x,e as i,f as k,g as L,i as a,p as N,q as U,h as n,w as l,t as h,s as q,R as I,x as B,y as R,j as w,v as C,k as z}from"./app-sWctXk48.js";const H=S({compatConfig:{MODE:3},setup(){const e=g(!1),t=g(null),p=g(null),f=g(!1),b=T(),y=E(),d=()=>y.go(-1),r=$("accountService"),s=$("loginService");return{authenticationError:e,login:t,password:p,rememberMe:f,accountService:r,doLogin:async()=>{const u={username:t.value,password:p.value,rememberMe:f.value};try{const c=(await j.post("api/authenticate",u)).headers.authorization;if(c&&c.slice(0,7)==="Bearer "){const m=c.slice(7,c.length);f.value?(localStorage.setItem("jhi-authenticationToken",m),sessionStorage.removeItem("jhi-authenticationToken")):(sessionStorage.setItem("jhi-authenticationToken",m),localStorage.removeItem("jhi-authenticationToken"))}e.value=!1,s.hideLogin(),await r.retrieveAccount(),b.path==="/forbidden"&&d()}catch{e.value=!0}},t$:V().t}}}),A={class:"modal-body"},O={class:"row justify-content-center"},F={class:"col-md-8"},G={class:"col-md-8"},P=["textContent"],Y=["textContent"];function Z(e,t,p,f,b,y){const d=i("b-alert"),r=i("b-form-input"),s=i("b-form-group"),o=i("b-form-checkbox"),u=i("b-button"),v=i("b-form"),c=i("b-link");return k(),L("div",A,[a("div",O,[a("div",F,[e.authenticationError?(k(),N(d,{key:0,show:"","data-cy":"loginError",variant:"danger",innerHTML:e.t$("login.messages.error.authentication")},null,8,["innerHTML"])):U("",!0)]),a("div",G,[n(v,{onSubmit:t[3]||(t[3]=q(m=>e.doLogin(),["prevent"]))},{default:l(()=>[n(s,{label:e.t$("global.form['username.label']"),"label-for":"username"},{default:l(()=>[n(r,{id:"username",type:"text",name:"username",autofocus:"",placeholder:e.t$("global.form['username.placeholder']"),modelValue:e.login,"onUpdate:modelValue":t[0]||(t[0]=m=>e.login=m),"data-cy":"username"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(s,{label:e.t$("login.form.password"),"label-for":"password"},{default:l(()=>[n(r,{id:"password",type:"password",name:"password",placeholder:e.t$("login.form['password.placeholder']"),modelValue:e.password,"onUpdate:modelValue":t[1]||(t[1]=m=>e.password=m),"data-cy":"password"},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(o,{id:"rememberMe",name:"rememberMe",modelValue:e.rememberMe,"onUpdate:modelValue":t[2]||(t[2]=m=>e.rememberMe=m),checked:""},{default:l(()=>[a("span",{textContent:h(e.t$("login.form.rememberme"))},null,8,P)]),_:1},8,["modelValue"]),a("div",null,[n(u,{"data-cy":"submit",type:"submit",variant:"primary",textContent:h(e.t$("login.form.button"))},null,8,["textContent"])])]),_:1}),t[4]||(t[4]=a("p",null,null,-1)),a("div",null,[n(d,{show:"",variant:"warning"},{default:l(()=>[n(c,{to:"/account/reset/request",class:"alert-link",textContent:h(e.t$("login.password.forgot")),"data-cy":"forgetYourPasswordSelector"},null,8,["textContent"])]),_:1})]),a("div",null,[n(d,{show:"",variant:"warning"},{default:l(()=>[a("span",{textContent:h(e.t$("global.messages.info.register.noaccount"))},null,8,Y),n(c,{to:"/register",class:"alert-link",textContent:h(e.t$("global.messages.info.register.link"))},null,8,["textContent"])]),_:1})])])])])}const J=x(H,[["render",Z]]),K=S({compatConfig:{MODE:3},name:"Login",components:{ribbon:I,"login-form":J,User:B,Lock:R},setup(){const e=g(""),t=g(""),p=g(""),f=E();return{username:e,password:t,captcha:p,handleLogin:()=>{function d(u){u.style.zIndex=1,u.style.color="#f56c6c",u.style.fontSize="12px",u.style.lineHeight="1",u.style.paddingTop="2px",u.style.position="absolute",u.style.top="100%",u.style.left="0"}var r=document.querySelectorAll(".el-form-item__content");if(e.value===""){var s=r[0].querySelector(".el-form-item__error");if(!s){var o=document.createElement("div");o.className="el-form-item__error",o.textContent="请输入用户名",d(o),r[0].appendChild(o)}return}if(t.value===""){var s=r[1].querySelector(".el-form-item__error");if(!s){var o=document.createElement("div");o.className="el-form-item__error",o.textContent="请输入密码",d(o),r[1].appendChild(o)}return}if(p.value===""){var s=r[2].querySelector(".el-form-item__error");if(!s){var o=document.createElement("div");o.className="el-form-item__error",o.textContent="请输入验证码",d(o),r[2].appendChild(o)}return}if(e.value==="admin"&&t.value==="admin"){if(p.value!=="SZGE"){var s=r[2].querySelector(".el-form-item__error");if(!s){var o=document.createElement("div");o.className="el-form-item__error",o.textContent="验证码错误",d(o),r[2].appendChild(o)}return}f.push("/home").then(()=>{window.location.reload()})}else{var s=r[0].querySelector(".el-form-item__error");if(!s){var o=document.createElement("div");o.className="el-form-item__error",o.textContent="用户名或密码错误",d(o),r[0].appendChild(o)}return}},refreshCaptcha:()=>{console.log("refreshCaptcha"),p.value=""},t$:V().t}}}),Q="/assets/captcha-CtEj_c_8.png",W={class:"common-layout"},X={class:"verification-img"},ee={class:"login-link"};function te(e,t,p,f,b,y){const d=i("User"),r=i("el-form-item"),s=i("Lock"),o=i("el-col"),u=i("el-row"),v=i("el-button"),c=i("router-link"),m=i("el-form"),M=i("el-main"),D=i("el-container");return k(),L("div",W,[n(D,null,{default:l(()=>[n(M,null,{default:l(()=>[t[7]||(t[7]=a("h2",{class:"login-area-title"},"远方123·研发费管理系统",-1)),n(m,{class:"login-form"},{default:l(()=>[n(r,null,{default:l(()=>[n(d,{style:{width:"20px"}}),w(a("input",{"onUpdate:modelValue":t[0]||(t[0]=_=>e.username=_),placeholder:"请输入账号",style:{width:"340px"}},null,512),[[C,e.username]])]),_:1}),n(r,null,{default:l(()=>[n(s,{style:{width:"20px"}}),w(a("input",{"onUpdate:modelValue":t[1]||(t[1]=_=>e.password=_),type:"password",placeholder:"请输入密码",style:{width:"340px"}},null,512),[[C,e.password]])]),_:1}),n(r,null,{default:l(()=>[n(u,{gutter:20},{default:l(()=>[n(o,{span:14},{default:l(()=>[n(s,{style:{width:"20px"}}),w(a("input",{"onUpdate:modelValue":t[2]||(t[2]=_=>e.captcha=_),placeholder:"请输入验证码",style:{width:"100px"}},null,512),[[C,e.captcha]])]),_:1}),n(o,{span:10},{default:l(()=>[a("div",X,[a("img",{src:Q,alt:"加载验证码",onClick:t[3]||(t[3]=(..._)=>e.refreshCaptcha&&e.refreshCaptcha(..._)),style:{width:"90px",cursor:"pointer",display:"block"}})])]),_:1})]),_:1})]),_:1}),n(r,null,{default:l(()=>[n(v,{type:"primary",class:"login-btn",onClick:e.handleLogin},{default:l(()=>t[4]||(t[4]=[z("登录")])),_:1},8,["onClick"]),a("p",ee,[n(c,{to:"/register"},{default:l(()=>t[5]||(t[5]=[a("span",null,"没有账号，立即注册",-1)])),_:1}),n(c,{to:"/forget-pwd"},{default:l(()=>t[6]||(t[6]=[a("span",{class:"forget-pwd"},"忘记密码?",-1)])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})])}const ne=x(K,[["render",te],["__scopeId","data-v-8fdc821c"]]);export{ne as default};
