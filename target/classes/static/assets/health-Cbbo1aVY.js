var w=Object.defineProperty;var O=(t,e,s)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var $=(t,e,s)=>O(t,typeof e!="symbol"?e+"":e,s);import{b as M,d as C,n as y,a as S,_ as v,g as i,i as a,t as l,Y as N,a2 as k,q as p,f as c,r as b,e as H,h as m,k as _,w as g,$ as B}from"./app-sWctXk48.js";class D{constructor(){$(this,"separator");this.separator="."}checkHealth(){return M.get("management/health")}transformHealthData(e){const s=[];return this.flattenHealthData(s,null,e.components),s}getBaseName(e){if(e)return e.split(".")[0]}getSubSystemName(e){if(e){const s=e.split(".");s.splice(0,1);const n=s.join(".");return n?` - ${n}`:""}}addHealthObject(e,s,n,h){const o={name:h,details:void 0,error:void 0},f={};let d=!1;for(const u in n)if(Object.hasOwn(n,u)){const r=n[u];u==="status"||u==="error"?o[u]=r:this.isHealthObject(r)||(f[u]=r,d=!0)}return d&&(o.details=f),(s||d||o.error)&&e.push(o),o}flattenHealthData(e,s,n){for(const h in n)if(Object.hasOwn(n,h)){const o=n[h];this.isHealthObject(o)&&(this.hasSubSystem(o)?(this.addHealthObject(e,!1,o,this.getModuleName(s,h)),this.flattenHealthData(e,this.getModuleName(s,h),o)):this.addHealthObject(e,!0,o,this.getModuleName(s,h)))}return e}getModuleName(e,s){return e&&s?e+this.separator+s:e||s||""}hasSubSystem(e){let s=!1;for(const n in e)if(Object.hasOwn(e,n)){const h=e[n];h&&h.status&&(s=!0)}return s}isHealthObject(e){let s=!1;for(const n in e)Object.hasOwn(e,n)&&n==="status"&&(s=!0);return s}}const j=C({compatConfig:{MODE:3},name:"JhiHealthModal",props:{currentHealth:{}},setup(){return{healthService:y("healthService",()=>new D,!0),t$:S().t}},methods:{baseName(t){return this.healthService.getBaseName(t)},subSystemName(t){return this.healthService.getSubSystemName(t)},readableValue(t){if(this.currentHealth.name==="diskSpace"){const e=t/1073741824;return e>1?`${e.toFixed(2)} GB`:`${(t/1048576).toFixed(2)} MB`}return typeof t=="object"?JSON.stringify(t):t.toString()}}}),x={class:"modal-body pad"},V={key:0},J=["textContent"],E={class:"table-responsive"},F={class:"table table-striped","aria-describedby":"Health"},L=["textContent"],P=["textContent"],q={class:"text-left"},z={class:"text-left"},G={key:1},I=["textContent"];function T(t,e,s,n,h,o){return c(),i("div",x,[t.currentHealth&&t.currentHealth.details?(c(),i("div",V,[a("h5",{textContent:l(t.t$("health.details.properties"))},null,8,J),a("div",E,[a("table",F,[a("thead",null,[a("tr",null,[a("th",{class:"text-left",textContent:l(t.t$("health.details.name")),scope:"col"},null,8,L),a("th",{class:"text-left",textContent:l(t.t$("health.details.value")),scope:"col"},null,8,P)])]),a("tbody",null,[(c(!0),i(N,null,k(t.currentHealth.details.details,(f,d)=>(c(),i("tr",{key:d},[a("td",q,l(d),1),a("td",z,l(t.readableValue(f)),1)]))),128))])])])])):p("",!0),t.currentHealth&&t.currentHealth.error?(c(),i("div",G,[a("h4",{textContent:l(t.t$("health.details.error"))},null,8,I),a("pre",null,l(t.currentHealth.error),1)])):p("",!0)])}const U=v(j,[["render",T]]),Y=C({compatConfig:{MODE:3},name:"JhiHealth",components:{"health-modal":U},setup(){const t=y("healthService",()=>new D,!0),e=b(null),s=b(null),n=b(!1);return{healthService:t,healthData:e,currentHealth:s,updatingHealth:n,t$:S().t}},mounted(){this.refresh()},methods:{baseName(t){return this.healthService.getBaseName(t)},getBadgeClass(t){return t==="UP"?"badge-success":"badge-danger"},refresh(){this.updatingHealth=!0,this.healthService.checkHealth().then(t=>{this.healthData=this.healthService.transformHealthData(t.data),this.updatingHealth=!1}).catch(t=>{t.status===503&&(this.healthData=this.healthService.transformHealthData(t.error)),this.updatingHealth=!1})},showHealth(t){this.currentHealth=t,this.$refs.healthModal.show()},subSystemName(t){return this.healthService.getSubSystemName(t)}}}),A=["textContent"],K=["disabled"],Q=["textContent"],R={class:"table-responsive"},W={id:"healthCheck",class:"table table-striped","aria-describedby":"Health check"},X=["textContent"],Z=["textContent"],tt=["textContent"],et=["textContent"],st={class:"text-center"},at=["textContent"],nt={class:"text-center"},lt=["onClick"],ot={key:0,class:"modal-title",id:"showHealthLabel"},rt=["textContent"];function ht(t,e,s,n,h,o){const f=H("font-awesome-icon"),d=H("health-modal"),u=H("b-modal");return c(),i("div",null,[a("h2",null,[a("span",{id:"health-page-heading",textContent:l(t.t$("health.title")),"data-cy":"healthPageHeading"},null,8,A),a("button",{class:"btn btn-primary float-right",onClick:e[0]||(e[0]=r=>t.refresh()),disabled:t.updatingHealth},[m(f,{icon:"sync"}),e[1]||(e[1]=_()),a("span",{textContent:l(t.t$("health['refresh.button']"))},null,8,Q)],8,K)]),a("div",R,[a("table",W,[a("thead",null,[a("tr",null,[a("th",{textContent:l(t.t$("health.table.service")),scope:"col"},null,8,X),a("th",{class:"text-center",textContent:l(t.t$("health.table.status")),scope:"col"},null,8,Z),a("th",{class:"text-center",textContent:l(t.t$("health.details.details")),scope:"col"},null,8,tt)])]),a("tbody",null,[(c(!0),i(N,null,k(t.healthData,r=>(c(),i("tr",{key:r.name},[a("td",null,[a("span",{textContent:l(t.t$("health.indicator."+t.baseName(r.name)))},null,8,et),_(" "+l(t.subSystemName(r.name)),1)]),a("td",st,[a("span",{class:B(["badge",t.getBadgeClass(r.status)]),textContent:l(t.t$("health.status."+r.status))},null,10,at)]),a("td",nt,[r.details||r.error?(c(),i("a",{key:0,class:"hand",onClick:it=>t.showHealth(r)},[m(f,{icon:"eye"})],8,lt)):p("",!0)])]))),128))])])]),m(u,{ref:"healthModal"},{"modal-title":g(()=>[t.currentHealth?(c(),i("h4",ot,[a("span",{textContent:l(t.t$("health.indicator."+t.baseName(t.currentHealth.name)))},null,8,rt),_(" "+l(t.subSystemName(t.currentHealth.name)),1)])):p("",!0)]),default:g(()=>[m(d,{"current-health":t.currentHealth},null,8,["current-health"])]),_:1},512)])}const ut=v(Y,[["render",ht]]);export{ut as default};
