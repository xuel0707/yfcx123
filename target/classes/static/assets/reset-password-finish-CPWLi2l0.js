import{d as $,n as p,r as l,a as v,b as y,_ as P,g as t,i as s,t as a,q as r,s as k,j as h,v as w,$ as f,f as n}from"./app-sWctXk48.js";import{u as C}from"./index-DPq3GusL.js";import{r as b,m as A,a as M,s as L}from"./index-BbpDxnmj.js";const _=$({compatConfig:{MODE:3},name:"ResetPasswordFinish",validations(){return{resetAccount:{newPassword:{required:b,minLength:A(4),maxLength:M(254)},confirmPassword:{sameAsPassword:L(this.resetAccount.newPassword)}}}},created(){var e,o;((o=(e=this.$route)==null?void 0:e.query)==null?void 0:o.key)!==void 0&&(this.key=this.$route.query.key),this.keyMissing=!this.key},setup(e){const o=p("loginService"),d=l(null),c=l(null),u=l(null),m=l(!1),i=l(null),g=l({newPassword:null,confirmPassword:null});return{openLogin:()=>{o.openLogin()},doNotMatch:d,success:c,error:u,keyMissing:m,key:i,resetAccount:g,v$:C(),t$:v().t}},methods:{finishReset(){if(this.doNotMatch=null,this.success=null,this.error=null,this.resetAccount.newPassword!==this.resetAccount.confirmPassword)this.doNotMatch="ERROR";else return y.post("api/account/reset-password/finish",{key:this.key,newPassword:this.resetAccount.newPassword}).then(()=>{this.success="OK"}).catch(()=>{this.success=null,this.error="ERROR"})}}}),R={class:"row justify-content-center"},q={class:"col-md-8"},N=["textContent"],D=["innerHTML"],T={key:1,class:"alert alert-danger"},V=["textContent"],E={key:2,class:"alert alert-success"},H=["innerHTML"],O=["textContent"],S={key:3,class:"alert alert-danger"},j=["textContent"],B={key:4,class:"alert alert-warning"},F=["textContent"],U={key:5},z={class:"form-group"},I=["textContent"],K=["placeholder"],G={key:0},J=["textContent"],Q=["textContent"],W=["textContent"],X={class:"form-group"},Y=["textContent"],Z=["placeholder"],x={key:0},ee=["textContent"],se=["disabled","textContent"];function te(e,o,d,c,u,m){return n(),t("div",null,[s("div",R,[s("div",q,[s("h1",{textContent:a(e.t$("reset.request.title"))},null,8,N),e.keyMissing?(n(),t("div",{key:0,class:"alert alert-danger",innerHTML:e.t$("reset.finish.messages.keymissing")},null,8,D)):r("",!0),e.error?(n(),t("div",T,[s("p",{textContent:a(e.t$("reset.finish.messages.error"))},null,8,V)])):r("",!0),e.success?(n(),t("div",E,[s("span",{innerHTML:e.t$("reset.finish.messages.success")},null,8,H),s("a",{class:"alert-link",onClick:o[0]||(o[0]=(...i)=>e.openLogin&&e.openLogin(...i)),textContent:a(e.t$("global.messages.info.authenticated.link"))},null,8,O)])):r("",!0),e.doNotMatch?(n(),t("div",S,[s("p",{textContent:a(e.t$("global.messages.error.dontmatch"))},null,8,j)])):r("",!0),!e.success&&!e.keyMissing?(n(),t("div",B,[s("p",{textContent:a(e.t$("reset.finish.messages.info"))},null,8,F)])):r("",!0),e.keyMissing?r("",!0):(n(),t("div",U,[e.success?r("",!0):(n(),t("form",{key:0,name:"form",onSubmit:o[3]||(o[3]=k(i=>e.finishReset(),["prevent"]))},[s("div",z,[s("label",{class:"form-control-label",for:"newPassword",textContent:a(e.t$("global.form['newpassword.label']"))},null,8,I),h(s("input",{type:"password",class:f(["form-control",{valid:!e.v$.resetAccount.newPassword.$invalid,invalid:e.v$.resetAccount.newPassword.$invalid}]),id:"newPassword",name:"newPassword",placeholder:e.t$("global.form['newpassword.placeholder']"),"onUpdate:modelValue":o[1]||(o[1]=i=>e.v$.resetAccount.newPassword.$model=i),minlength:"4",maxlength:"50",required:"","data-cy":"resetPassword"},null,10,K),[[w,e.v$.resetAccount.newPassword.$model]]),e.v$.resetAccount.newPassword.$anyDirty&&e.v$.resetAccount.newPassword.$invalid?(n(),t("div",G,[e.v$.resetAccount.newPassword.required?r("",!0):(n(),t("small",{key:0,class:"form-text text-danger",textContent:a(e.t$("global.messages.validate.newpassword.required"))},null,8,J)),e.v$.resetAccount.newPassword.minLength?r("",!0):(n(),t("small",{key:1,class:"form-text text-danger",textContent:a(e.t$("global.messages.validate.newpassword.minlength"))},null,8,Q)),e.v$.resetAccount.newPassword.maxLength?r("",!0):(n(),t("small",{key:2,class:"form-text text-danger",textContent:a(e.t$("global.messages.validate.newpassword.maxlength"))},null,8,W))])):r("",!0)]),s("div",X,[s("label",{class:"form-control-label",for:"confirmPassword",textContent:a(e.t$("global.form['confirmpassword.label']"))},null,8,Y),h(s("input",{type:"password",class:f(["form-control",{valid:!e.v$.resetAccount.confirmPassword.$invalid,invalid:e.v$.resetAccount.confirmPassword.$invalid}]),id:"confirmPassword",name:"confirmPassword",placeholder:e.t$("global.form['confirmpassword.placeholder']"),"onUpdate:modelValue":o[2]||(o[2]=i=>e.v$.resetAccount.confirmPassword.$model=i),minlength:"4",maxlength:"50",required:"","data-cy":"confirmResetPassword"},null,10,Z),[[w,e.v$.resetAccount.confirmPassword.$model]]),e.v$.resetAccount.confirmPassword.$anyDirty&&e.v$.resetAccount.confirmPassword.$invalid?(n(),t("div",x,[e.v$.resetAccount.confirmPassword.sameAsPassword?r("",!0):(n(),t("small",{key:0,class:"form-text text-danger",textContent:a(e.t$("global.messages.error.dontmatch"))},null,8,ee))])):r("",!0)]),s("button",{type:"submit",disabled:e.v$.resetAccount.$invalid,class:"btn btn-primary",textContent:a(e.t$("password.form.button")),"data-cy":"submit"},null,8,se)],32))]))])])])}const ie=P(_,[["render",te]]);export{ie as default};
