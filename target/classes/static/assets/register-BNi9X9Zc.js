import{b,d as L,n as $,r as i,a as x,l as k,_ as E,g as t,i as o,t as r,q as n,s as P,j as d,v as m,$ as g,f as s}from"./app-sWctXk48.js";import{u as R}from"./index-DPq3GusL.js";import{r as u,m as c,a as v,e as _,s as q,c as M}from"./index-BbpDxnmj.js";import{L as T,E as D}from"./constants-DfqkunPD.js";class H{processRegistration(a){return b.post("api/register",a)}}const S=M.regex(/^[a-zA-Z0-9!$&*+=?^_`{|}~.-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$|^[_.@A-Za-z0-9-]+$/),U=L({compatConfig:{MODE:3},name:"Register",validations(){return{registerAccount:{login:{required:u,minLength:c(1),maxLength:v(50),pattern:S},email:{required:u,minLength:c(5),maxLength:v(254),email:_},password:{required:u,minLength:c(4),maxLength:v(254)}},confirmPassword:{required:u,minLength:c(4),maxLength:v(50),sameAsPassword:q(this.registerAccount.password)}}},setup(e){const a=$("loginService"),h=$("registerService",()=>new H,!0),p=$("currentLanguage",()=>k(()=>navigator.language??"zh-cn"),!0),f=i(""),w=i(""),l=i(""),C=i(!1),y=i(null),A=i({login:void 0,email:void 0,password:void 0});return{openLogin:()=>{a.openLogin()},currentLanguage:p,registerService:h,error:f,errorEmailExists:w,errorUserExists:l,success:C,confirmPassword:y,registerAccount:A,v$:R(),t$:x().t}},methods:{register(){this.error=null,this.errorUserExists=null,this.errorEmailExists=null,this.registerAccount.langKey=this.currentLanguage,this.registerService.processRegistration(this.registerAccount).then(()=>{this.success=!0}).catch(e=>{this.success=null,e.response.status===400&&e.response.data.type===T?this.errorUserExists="ERROR":e.response.status===400&&e.response.data.type===D?this.errorEmailExists="ERROR":this.error="ERROR"})}}}),z={class:"row justify-content-center"},V={class:"col-md-8 toastify-container"},Z=["textContent"],O=["innerHTML"],j=["innerHTML"],I=["innerHTML"],Y=["innerHTML"],B={class:"row justify-content-center"},N={class:"col-md-8"},F={class:"form-group"},G=["textContent"],K=["placeholder"],J={key:0},Q=["textContent"],W=["textContent"],X=["textContent"],ee=["textContent"],te={class:"form-group"},se=["textContent"],ne=["placeholder"],oe={key:0},re=["textContent"],ae=["textContent"],le=["textContent"],ie=["textContent"],de={class:"form-group"},me=["textContent"],ge=["placeholder"],ue={key:0},ce=["textContent"],ve=["textContent"],$e=["textContent"],he={class:"form-group"},pe=["textContent"],fe=["placeholder"],we={key:0},Ce=["textContent"],ye=["textContent"],Ae=["textContent"],be=["textContent"],Le=["disabled","textContent"],xe={class:"alert alert-warning"},ke=["textContent"],Ee=["textContent"],Pe=["innerHTML"];function Re(e,a,h,p,f,w){return s(),t("div",null,[o("div",z,[o("div",V,[o("h1",{textContent:r(e.t$("register.title")),id:"register-title","data-cy":"registerTitle"},null,8,Z),e.success?(s(),t("div",{key:0,class:"alert alert-success",role:"alert",innerHTML:e.t$("register.messages.success")},null,8,O)):n("",!0),e.error?(s(),t("div",{key:1,class:"alert alert-danger",role:"alert",innerHTML:e.t$("register.messages.error.fail")},null,8,j)):n("",!0),e.errorUserExists?(s(),t("div",{key:2,class:"alert alert-danger",role:"alert",innerHTML:e.t$("register.messages.error.userexists")},null,8,I)):n("",!0),e.errorEmailExists?(s(),t("div",{key:3,class:"alert alert-danger",role:"alert",innerHTML:e.t$("register.messages.error.emailexists")},null,8,Y)):n("",!0)])]),o("div",B,[o("div",N,[e.success?n("",!0):(s(),t("form",{key:0,id:"register-form",name:"registerForm",onSubmit:a[4]||(a[4]=P(l=>e.register(),["prevent"])),"no-validate":""},[o("div",F,[o("label",{class:"form-control-label",for:"username",textContent:r(e.t$("global.form['username.label']"))},null,8,G),d(o("input",{type:"text",class:g(["form-control",{valid:!e.v$.registerAccount.login.$invalid,invalid:e.v$.registerAccount.login.$invalid}]),"onUpdate:modelValue":a[0]||(a[0]=l=>e.v$.registerAccount.login.$model=l),id:"username",name:"login",required:"",minlength:"1",maxlength:"50",pattern:"^[a-zA-Z0-9!#$&'*+=?^_`{|}~.-]+@?[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$",placeholder:e.t$("global.form['username.placeholder']"),"data-cy":"username"},null,10,K),[[m,e.v$.registerAccount.login.$model]]),e.v$.registerAccount.login.$anyDirty&&e.v$.registerAccount.login.$invalid?(s(),t("div",J,[e.v$.registerAccount.login.required?n("",!0):(s(),t("small",{key:0,class:"form-text text-danger",textContent:r(e.t$("register.messages.validate.login.required"))},null,8,Q)),e.v$.registerAccount.login.minLength?n("",!0):(s(),t("small",{key:1,class:"form-text text-danger",textContent:r(e.t$("register.messages.validate.login.minlength"))},null,8,W)),e.v$.registerAccount.login.maxLength?n("",!0):(s(),t("small",{key:2,class:"form-text text-danger",textContent:r(e.t$("register.messages.validate.login.maxlength"))},null,8,X)),e.v$.registerAccount.login.pattern?n("",!0):(s(),t("small",{key:3,class:"form-text text-danger",textContent:r(e.t$("register.messages.validate.login.pattern"))},null,8,ee))])):n("",!0)]),o("div",te,[o("label",{class:"form-control-label",for:"email",textContent:r(e.t$("global.form['email.label']"))},null,8,se),d(o("input",{type:"email",class:g(["form-control",{valid:!e.v$.registerAccount.email.$invalid,invalid:e.v$.registerAccount.email.$invalid}]),id:"email",name:"email","onUpdate:modelValue":a[1]||(a[1]=l=>e.v$.registerAccount.email.$model=l),minlength:"5",maxlength:"254",email:"",required:"",placeholder:e.t$("global.form['email.placeholder']"),"data-cy":"email"},null,10,ne),[[m,e.v$.registerAccount.email.$model]]),e.v$.registerAccount.email.$anyDirty&&e.v$.registerAccount.email.$invalid?(s(),t("div",oe,[e.v$.registerAccount.email.required?n("",!0):(s(),t("small",{key:0,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.email.required"))},null,8,re)),e.v$.registerAccount.email.email?n("",!0):(s(),t("small",{key:1,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.email.invalid"))},null,8,ae)),e.v$.registerAccount.email.minLength?n("",!0):(s(),t("small",{key:2,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.email.minlength"))},null,8,le)),e.v$.registerAccount.email.maxLength?n("",!0):(s(),t("small",{key:3,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.email.maxlength"))},null,8,ie))])):n("",!0)]),o("div",de,[o("label",{class:"form-control-label",for:"firstPassword",textContent:r(e.t$("global.form['newpassword.label']"))},null,8,me),d(o("input",{type:"password",class:g(["form-control",{valid:!e.v$.registerAccount.password.$invalid,invalid:e.v$.registerAccount.password.$invalid}]),id:"firstPassword",name:"password","onUpdate:modelValue":a[2]||(a[2]=l=>e.v$.registerAccount.password.$model=l),minlength:"4",maxlength:"50",required:"",placeholder:e.t$("global.form['newpassword.placeholder']"),"data-cy":"firstPassword"},null,10,ge),[[m,e.v$.registerAccount.password.$model]]),e.v$.registerAccount.password.$anyDirty&&e.v$.registerAccount.password.$invalid?(s(),t("div",ue,[e.v$.registerAccount.password.required?n("",!0):(s(),t("small",{key:0,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.newpassword.required"))},null,8,ce)),e.v$.registerAccount.password.minLength?n("",!0):(s(),t("small",{key:1,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.newpassword.minlength"))},null,8,ve)),e.v$.registerAccount.password.maxLength?n("",!0):(s(),t("small",{key:2,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.newpassword.maxlength"))},null,8,$e))])):n("",!0)]),o("div",he,[o("label",{class:"form-control-label",for:"secondPassword",textContent:r(e.t$("global.form['confirmpassword.label']"))},null,8,pe),d(o("input",{type:"password",class:g(["form-control",{valid:!e.v$.confirmPassword.$invalid,invalid:e.v$.confirmPassword.$invalid}]),id:"secondPassword",name:"confirmPasswordInput","onUpdate:modelValue":a[3]||(a[3]=l=>e.v$.confirmPassword.$model=l),minlength:"4",maxlength:"50",required:"",placeholder:e.t$("global.form['confirmpassword.placeholder']"),"data-cy":"secondPassword"},null,10,fe),[[m,e.v$.confirmPassword.$model]]),e.v$.confirmPassword.$dirty&&e.v$.confirmPassword.$invalid?(s(),t("div",we,[e.v$.confirmPassword.required?n("",!0):(s(),t("small",{key:0,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.confirmpassword.required"))},null,8,Ce)),e.v$.confirmPassword.minLength?n("",!0):(s(),t("small",{key:1,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.confirmpassword.minlength"))},null,8,ye)),e.v$.confirmPassword.maxLength?n("",!0):(s(),t("small",{key:2,class:"form-text text-danger",textContent:r(e.t$("global.messages.validate.confirmpassword.maxlength"))},null,8,Ae)),e.v$.confirmPassword.sameAsPassword?n("",!0):(s(),t("small",{key:3,class:"form-text text-danger",textContent:r(e.t$("global.messages.error.dontmatch"))},null,8,be))])):n("",!0)]),o("button",{type:"submit",disabled:e.v$.$invalid,class:"btn btn-primary",textContent:r(e.t$("register.form.button")),"data-cy":"submit"},null,8,Le)],32)),a[6]||(a[6]=o("p",null,null,-1)),o("div",xe,[o("span",{textContent:r(e.t$("global.messages.info.authenticated.prefix"))},null,8,ke),o("a",{class:"alert-link",onClick:a[5]||(a[5]=l=>e.openLogin()),textContent:r(e.t$("global.messages.info.authenticated.link"))},null,8,Ee),o("span",{innerHTML:e.t$("global.messages.info.authenticated.suffix")},null,8,Pe)])])])])}const He=E(U,[["render",Re]]);export{He as default};
